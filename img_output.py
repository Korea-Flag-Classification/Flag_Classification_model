from flask import Flask, render_template, request
from keras.models import load_model
from PIL import Image
import keras
import tensorflow as tf
import matplotlib.pyplot as plt
import cv2
import os
import numpy as np
#import model

os.environ['KMP_DUPLICATE_LIB_OK']='True' ## 오류 방지 for mac

model = load_model('xception.h5') # 학습된 모델 불러오기

#### 아래는 구글 이미지 주 복사한 것. 임의의 사용자는 구글 이미지 내에서 임의의 주소를 복사해올 것 ####
file_path = tf.keras.utils.get_file('tes11','data:image/jpeg;base64,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') # 2번째 항에 웹에서 이미지 주소 붙이기
image = Image.open(file_path).convert('RGB')
image = image.resize((200,200))
image = np.array(image)

image = image.reshape((200,200,3))
plt.imshow(image)
x_test = [image]
x_test = np.array(x_test)
x_test = x_test / 255

pred = model.predict(x_test)
print(pred)
if pred < 0.5:
    print('태극기입니다')

else:
    print('태극기가 아닙니다')